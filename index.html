<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ST ing Grade Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Poppins', sans-serif;
    }
    .gradient-bg {
      background: #1a1a2e;
    }
    .card-gradient {
      background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
      backdrop-filter: blur(10px);
    }
    .tab-active {
      background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%);
      box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
    }
    .semester-tab-active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    .input-field {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      transition: all 0.3s ease;
      min-height: 44px;
      font-size: 16px;
    }
    .input-field:focus {
      background: rgba(255,255,255,0.18);
      border-color: rgba(255,255,255,0.4);
      outline: none;
      box-shadow: 0 0 0 2px rgba(255,255,255,0.1);
    }
    .result-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.06) 100%);
      border: 2px solid rgba(255,255,255,0.25);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .subject-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 100%);
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
    }
    .subject-card:hover {
      transform: translateY(-2px);
      border-color: rgba(255,255,255,0.25);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    }
    .glow-text {
      text-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }
    .reset-btn {
      background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
      transition: all 0.3s ease;
    }
    .reset-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 20px rgba(255, 65, 108, 0.5);
    }
    .coming-soon-card {
      background: linear-gradient(145deg, rgba(233, 69, 96, 0.1) 0%, rgba(255, 107, 107, 0.05) 100%);
      border: 2px dashed rgba(233, 69, 96, 0.4);
    }

    .scroll-container {
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,0.3) rgba(255,255,255,0.1);
    }
    .scroll-container::-webkit-scrollbar {
      width: 6px;
    }
    .scroll-container::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.1);
      border-radius: 3px;
    }
    .scroll-container::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.3);
      border-radius: 3px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full gradient-bg text-white overflow-auto scroll-container">
  <div id="app" class="min-h-full flex flex-col"><!-- Header -->
   <header class="py-6 px-4 text-center border-b border-white/10">
    <div class="flex items-center justify-center gap-3 mb-2">
     <svg class="w-10 h-10 md:w-12 md:h-12 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
     </svg>
     <h1 id="app-title" class="text-3xl md:text-4xl font-bold glow-text">ST ing Grade Calculator</h1>
    </div>
    <p class="text-gray-400 text-sm md:text-base max-w-2xl mx-auto">Ø§Ø­Ø³Ø¨ Ù…Ø¹Ø¯Ù‘Ù„Ùƒ Ø¨Ø³Ø±Ø¹Ø© ÙˆØ¨Ø¯Ù‚Ù‘Ø© Ù„ÙƒÙ„ Ù…ÙˆØ³Ù…ØŒ Ø¨ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø³ÙŠØ·Ø© ÙˆÙ…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ø§Ù„Ø¬ÙˆØ§Ù„</p>
   </header><!-- Year Tabs -->
   <nav class="px-4 py-4">
    <div class="flex flex-wrap justify-center gap-2 md:gap-3 max-w-4xl mx-auto"><button onclick="selectYear(1)" id="year-tab-1" class="year-tab tab-active px-4 py-2 md:px-6 md:py-3 rounded-xl font-semibold text-sm md:text-base transition-all duration-300"> 1st Year </button> <button onclick="selectYear(2)" id="year-tab-2" class="year-tab px-4 py-2 md:px-6 md:py-3 rounded-xl font-semibold text-sm md:text-base bg-white/10 hover:bg-white/20 transition-all duration-300"> 2nd Year </button> <button onclick="selectYear(3)" id="year-tab-3" class="year-tab px-4 py-2 md:px-6 md:py-3 rounded-xl font-semibold text-sm md:text-base bg-white/10 hover:bg-white/20 transition-all duration-300"> 3rd Year </button> <button onclick="selectYear(4)" id="year-tab-4" class="year-tab px-4 py-2 md:px-6 md:py-3 rounded-xl font-semibold text-sm md:text-base bg-white/10 hover:bg-white/20 transition-all duration-300"> 4th Year </button> <button onclick="selectYear(5)" id="year-tab-5" class="year-tab px-4 py-2 md:px-6 md:py-3 rounded-xl font-semibold text-sm md:text-base bg-white/10 hover:bg-white/20 transition-all duration-300"> 5th Year </button>
    </div>
   </nav><!-- Main Content -->
   <main class="flex-1 px-4 pb-8">
    <div class="max-w-5xl mx-auto"><!-- Semester Tabs -->
     <div id="semester-tabs" class="flex justify-center gap-3 mb-6"><button onclick="selectSemester(1)" id="sem-tab-1" class="semester-tab semester-tab-active px-5 py-2 rounded-lg font-medium text-sm transition-all duration-300"> Semester 1 </button> <button onclick="selectSemester(2)" id="sem-tab-2" class="semester-tab px-5 py-2 rounded-lg font-medium text-sm bg-white/10 hover:bg-white/20 transition-all duration-300"> Semester 2 </button>
     </div><!-- Content Area -->
     <div id="content-area"><!-- Will be populated by JavaScript -->
     </div>
    </div>
   </main><!-- Footer -->
   <footer class="py-4 px-4 border-t border-white/10 text-center">
    <p class="text-gray-400 text-sm">Project by: <span id="dev-name" class="text-purple-300 font-semibold">Khalil Doua</span></p><a href="https://t.me/KhqLiL" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-purple-300 hover:text-purple-200 text-sm mt-1 transition-colors">
     <svg class="w-4 h-4" fill="currentColor" viewbox="0 0 24 24">
      <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z" />
     </svg> @KhqLiL </a>
   </footer>
  </div>
  <script>
    // Configuration
    const defaultConfig = {
      app_title: "ğŸ“ ST ing Grade Calculator",
      developer_name: "Khalil Doua"
    };

    let config = { ...defaultConfig };

    // Data Structure for Subjects
    const subjectsData = {
      1: { // Year 1
        1: [ // Semester 1
          { name: "Physics 1 (Physique 1)", coef: 4, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Chemistry 1 (Chimie 1)", coef: 4, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Computer Science (Informatique)", coef: 2, fields: ["TD"], weights: [1] },
          { name: "Algebra 1 (AlgÃ¨bre 1)", coef: 2, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Analysis 1 (Analyse 1)", coef: 3, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Probability & Statistics", coef: 2, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Les MÃ©tiers", coef: 1, fields: ["Exam"], weights: [1] },
          { name: "Ethics (Ã‰thique)", coef: 1, fields: ["Exam"], weights: [1] }
        ],
        2: [ // Semester 2
          { name: "Physics 2", coef: 4, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Chemistry 2", coef: 4, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Programming (Informatique 2)", coef: 2, fields: ["TD"], weights: [1] },
          { name: "Algebra 2", coef: 2, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Analysis 2", coef: 3, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Dessin", coef: 2, fields: ["TP"], weights: [1] },
          { name: "MÃ©tier", coef: 1, fields: ["Exam"], weights: [1] },
          { name: "English (Anglais)", coef: 1, fields: ["Exam"], weights: [1] }
        ]
      },
      2: { // Year 2
        1: [ // Semester 3
          { name: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ 3 â€” Analyse 3", coef: 3, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø¯ÙŠ 1 â€” Analyse NumÃ©rique 1", coef: 3, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Ø§Ù„Ù…ÙˆØ¬Ø§Øª ÙˆØ§Ù„Ø§Ù‡ØªØ²Ø§Ø²Ø§Øª â€” Ondes et Vibrations", coef: 3, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© â€” Ã‰lectricitÃ© Fondamentale", coef: 3, fields: ["TD", "TP", "Exam"], weights: [0.2, 0.2, 0.6] },
          { name: "Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒ Ø§Ù„Ù†Ø¸Ø±ÙŠØ© â€” MÃ©canique ThÃ©orique", coef: 2, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø¨Ù„ØºØ© Ø¨Ø§ÙŠØ«ÙˆÙ† â€” Programmation Python", coef: 2, fields: ["TD", "Exam"], weights: [0.4, 0.6] },
          { name: "Ø§Ù„Ø±Ø³Ù… Ø¨Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ â€” CAO", coef: 1, fields: ["Exam"], weights: [1] },
          { name: "Ø§Ù„Ø·Ø§Ù‚Ø© ÙˆØ§Ù„Ø¨ÙŠØ¦Ø© â€” Ã‰nergie et Environnement", coef: 1, fields: ["Exam"], weights: [1] },
          { name: "Ø§Ù„Ù…ÙˆØ§Ø¯ ÙÙŠ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© â€” MatÃ©riaux", coef: 1, fields: ["Exam"], weights: [1] }
        ]
      }
    };

    // Store grades
    const grades = {};

    // Current selection
    let currentYear = 1;
    let currentSemester = 1;

    // Initialize grades storage
    function initGrades() {
      for (let year = 1; year <= 5; year++) {
        grades[year] = {};
        for (let sem = 1; sem <= 2; sem++) {
          grades[year][sem] = {};
        }
      }
    }

    // Select Year
    function selectYear(year) {
      currentYear = year;
      currentSemester = 1;
      
      // Update year tabs
      document.querySelectorAll('.year-tab').forEach((tab, idx) => {
        if (idx + 1 === year) {
          tab.classList.add('tab-active');
          tab.classList.remove('bg-white/10', 'hover:bg-white/20');
        } else {
          tab.classList.remove('tab-active');
          tab.classList.add('bg-white/10', 'hover:bg-white/20');
        }
      });

      // Update semester tabs
      updateSemesterTabs();
      renderContent();
    }

    // Update Semester Tabs
    function updateSemesterTabs() {
      const semBase = (currentYear - 1) * 2;
      document.getElementById('sem-tab-1').textContent = `Semester ${semBase + 1}`;
      document.getElementById('sem-tab-2').textContent = `Semester ${semBase + 2}`;
      
      // Reset active state
      document.querySelectorAll('.semester-tab').forEach((tab, idx) => {
        if (idx === 0) {
          tab.classList.add('semester-tab-active');
          tab.classList.remove('bg-white/10', 'hover:bg-white/20');
        } else {
          tab.classList.remove('semester-tab-active');
          tab.classList.add('bg-white/10', 'hover:bg-white/20');
        }
      });
    }

    // Select Semester
    function selectSemester(sem) {
      currentSemester = sem;
      
      document.querySelectorAll('.semester-tab').forEach((tab, idx) => {
        if (idx + 1 === sem) {
          tab.classList.add('semester-tab-active');
          tab.classList.remove('bg-white/10', 'hover:bg-white/20');
        } else {
          tab.classList.remove('semester-tab-active');
          tab.classList.add('bg-white/10', 'hover:bg-white/20');
        }
      });

      renderContent();
    }

    // Calculate Subject Average
    function calculateSubjectAverage(year, sem, subjectIdx) {
      const subjects = subjectsData[year]?.[sem];
      if (!subjects) return null;
      
      const subject = subjects[subjectIdx];
      const subjectGrades = grades[year][sem][subjectIdx] || {};
      
      let sum = 0;
      let hasAnyGrade = false;
      
      subject.fields.forEach((field, fieldIdx) => {
        const grade = parseFloat(subjectGrades[field]) || 0;
        if (subjectGrades[field] !== undefined && subjectGrades[field] !== '') {
          hasAnyGrade = true;
        }
        sum += grade * subject.weights[fieldIdx];
      });
      
      return hasAnyGrade ? sum : null;
    }

    // Calculate Semester Average
    function calculateSemesterAverage(year, sem) {
      const subjects = subjectsData[year]?.[sem];
      if (!subjects) return null;
      
      let totalWeighted = 0;
      let totalCoef = 0;
      let hasAnyGrade = false;
      
      subjects.forEach((subject, idx) => {
        const avg = calculateSubjectAverage(year, sem, idx);
        if (avg !== null) {
          hasAnyGrade = true;
          totalWeighted += avg * subject.coef;
          totalCoef += subject.coef;
        }
      });
      
      return hasAnyGrade && totalCoef > 0 ? totalWeighted / totalCoef : null;
    }

    // Handle Grade Input
    function handleGradeInput(subjectIdx, field, value) {
      if (!grades[currentYear][currentSemester][subjectIdx]) {
        grades[currentYear][currentSemester][subjectIdx] = {};
      }
      
      // Validate input
      let numValue = parseFloat(value);
      if (isNaN(numValue)) {
        grades[currentYear][currentSemester][subjectIdx][field] = '';
      } else {
        numValue = Math.max(0, Math.min(20, numValue));
        grades[currentYear][currentSemester][subjectIdx][field] = numValue;
      }
      
      updateAverages();
    }

    // Update Averages Display
    function updateAverages() {
      const subjects = subjectsData[currentYear]?.[currentSemester];
      if (!subjects) return;
      
      subjects.forEach((subject, idx) => {
        const avg = calculateSubjectAverage(currentYear, currentSemester, idx);
        const avgEl = document.getElementById(`subject-avg-${idx}`);
        if (avgEl) {
          avgEl.textContent = avg !== null ? avg.toFixed(2) : '--';
          avgEl.className = avg !== null ? (avg >= 10 ? 'text-green-400 font-bold' : 'text-red-400 font-bold') : 'text-gray-400';
        }
      });
      
      const semAvg = calculateSemesterAverage(currentYear, currentSemester);
      const semAvgEl = document.getElementById('semester-average');
      if (semAvgEl) {
        semAvgEl.textContent = semAvg !== null ? semAvg.toFixed(2) : '--';
        semAvgEl.className = semAvg !== null ? (semAvg >= 10 ? 'text-4xl font-bold text-green-400' : 'text-4xl font-bold text-red-400') : 'text-4xl font-bold text-gray-400';
      }
    }

    // Reset Current Semester
    function resetSemester() {
      grades[currentYear][currentSemester] = {};
      renderContent();
    }

    // Render Content
    function renderContent() {
      const contentArea = document.getElementById('content-area');
      const semBase = (currentYear - 1) * 2;
      const actualSemester = semBase + currentSemester;
      
      // Check if data available for this year/semester
      if (currentYear === 1 || (currentYear === 2 && currentSemester === 1)) {
        renderCalculator(contentArea);
      } else {
        renderComingSoon(contentArea, actualSemester);
      }
    }

    // Render Calculator
    function renderCalculator(container) {
      const subjects = subjectsData[currentYear][currentSemester];
      const totalCoef = subjects.reduce((sum, s) => sum + s.coef, 0);
      
      let html = `
        <div class="space-y-4">
          <!-- Semester Average Card -->
          <div class="result-card rounded-2xl p-6 text-center">
            <p class="text-gray-300 mb-2 text-lg font-medium">Semester Average</p>
            <p id="semester-average" class="text-4xl md:text-5xl font-bold text-gray-400">--</p>
            <p class="text-gray-400 text-sm mt-3">Total Coefficients: ${totalCoef}</p>
          </div>

          <!-- Reset Button -->
          <div class="flex justify-end">
            <button onclick="resetSemester()" class="reset-btn px-4 py-2 rounded-lg text-white font-medium flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
              </svg>
              Reset
            </button>
          </div>

          <!-- Desktop Table -->
          <div class="hidden md:block overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="border-b border-white/20">
                  <th class="text-left py-3 px-4 text-gray-300 font-medium">Subject</th>
                  <th class="text-center py-3 px-2 text-gray-300 font-medium">Coef</th>
                  <th class="text-center py-3 px-2 text-gray-300 font-medium">TD</th>
                  <th class="text-center py-3 px-2 text-gray-300 font-medium">TP</th>
                  <th class="text-center py-3 px-2 text-gray-300 font-medium">Exam</th>
                  <th class="text-center py-3 px-4 text-gray-300 font-medium">Average</th>
                </tr>
              </thead>
              <tbody>
      `;

      subjects.forEach((subject, idx) => {
        const subjectGrades = grades[currentYear][currentSemester][idx] || {};
        const avg = calculateSubjectAverage(currentYear, currentSemester, idx);
        const avgClass = avg !== null ? (avg >= 10 ? 'text-green-400 font-bold' : 'text-red-400 font-bold') : 'text-gray-400';
        
        html += `
          <tr class="border-b border-white/10 hover:bg-white/5 transition-colors">
            <td class="py-3 px-4">
              <span class="font-medium">${subject.name}</span>
            </td>
            <td class="text-center py-3 px-2">
              <span class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded-lg text-sm font-medium">${subject.coef}</span>
            </td>
            <td class="text-center py-3 px-2">
              ${subject.fields.includes('TD') ? `
                <input type="number" step="0.25" min="0" max="20" 
                  value="${subjectGrades.TD !== undefined ? subjectGrades.TD : ''}"
                  onchange="handleGradeInput(${idx}, 'TD', this.value)"
                  class="input-field w-20 text-center py-2 px-2 rounded-lg text-white"
                  placeholder="--">
              ` : '<span class="text-gray-500">-</span>'}
            </td>
            <td class="text-center py-3 px-2">
              ${subject.fields.includes('TP') ? `
                <input type="number" step="0.25" min="0" max="20" 
                  value="${subjectGrades.TP !== undefined ? subjectGrades.TP : ''}"
                  onchange="handleGradeInput(${idx}, 'TP', this.value)"
                  class="input-field w-20 text-center py-2 px-2 rounded-lg text-white"
                  placeholder="--">
              ` : '<span class="text-gray-500">-</span>'}
            </td>
            <td class="text-center py-3 px-2">
              ${subject.fields.includes('Exam') ? `
                <input type="number" step="0.25" min="0" max="20" 
                  value="${subjectGrades.Exam !== undefined ? subjectGrades.Exam : ''}"
                  onchange="handleGradeInput(${idx}, 'Exam', this.value)"
                  class="input-field w-20 text-center py-2 px-2 rounded-lg text-white"
                  placeholder="--">
              ` : '<span class="text-gray-500">-</span>'}
            </td>
            <td class="text-center py-3 px-4">
              <span id="subject-avg-${idx}" class="${avgClass}">${avg !== null ? avg.toFixed(2) : '--'}</span>
            </td>
          </tr>
        `;
      });

      html += `
              </tbody>
            </table>
          </div>

          <!-- Mobile Cards -->
          <div class="md:hidden space-y-3">
      `;

      subjects.forEach((subject, idx) => {
        const subjectGrades = grades[currentYear][currentSemester][idx] || {};
        const avg = calculateSubjectAverage(currentYear, currentSemester, idx);
        const avgClass = avg !== null ? (avg >= 10 ? 'text-green-400 font-bold' : 'text-red-400 font-bold') : 'text-gray-400';
        
        html += `
          <div class="subject-card rounded-xl p-4">
            <div class="flex justify-between items-start mb-3">
              <h3 class="font-semibold text-white flex-1 pr-2">${subject.name}</h3>
              <span class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded-lg text-xs font-medium whitespace-nowrap">Coef: ${subject.coef}</span>
            </div>
            <div class="grid grid-cols-3 gap-2 mb-3">
              ${subject.fields.includes('TD') ? `
                <div class="text-center">
                  <label class="text-xs text-gray-400 block mb-1 font-medium">TD</label>
                  <input type="number" step="0.25" min="0" max="20" 
                    value="${subjectGrades.TD !== undefined ? subjectGrades.TD : ''}"
                    onchange="handleGradeInput(${idx}, 'TD', this.value)"
                    class="input-field w-full text-center py-3 px-3 rounded-lg text-white"
                    placeholder="--">
                </div>
              ` : '<div></div>'}
              ${subject.fields.includes('TP') ? `
                <div class="text-center">
                  <label class="text-xs text-gray-400 block mb-1 font-medium">TP</label>
                  <input type="number" step="0.25" min="0" max="20" 
                    value="${subjectGrades.TP !== undefined ? subjectGrades.TP : ''}"
                    onchange="handleGradeInput(${idx}, 'TP', this.value)"
                    class="input-field w-full text-center py-3 px-3 rounded-lg text-white"
                    placeholder="--">
                </div>
              ` : '<div></div>'}
              ${subject.fields.includes('Exam') ? `
                <div class="text-center">
                  <label class="text-xs text-gray-400 block mb-1 font-medium">Exam</label>
                  <input type="number" step="0.25" min="0" max="20" 
                    value="${subjectGrades.Exam !== undefined ? subjectGrades.Exam : ''}"
                    onchange="handleGradeInput(${idx}, 'Exam', this.value)"
                    class="input-field w-full text-center py-3 px-3 rounded-lg text-white"
                    placeholder="--">
                </div>
              ` : '<div></div>'}
            </div>
            <div class="flex justify-between items-center pt-2 border-t border-white/10">
              <span class="text-gray-400 text-sm">Average:</span>
              <span id="subject-avg-${idx}" class="${avgClass} text-lg">${avg !== null ? avg.toFixed(2) : '--'}</span>
            </div>
          </div>
        `;
      });

      html += `
          </div>
        </div>
      `;

      container.innerHTML = html;
      updateAverages();
    }

    // Render Coming Soon
    function renderComingSoon(container, semesterNum) {
      container.innerHTML = `
        <div class="coming-soon-card rounded-2xl p-8 md:p-12 text-center max-w-2xl mx-auto">
          <div class="text-6xl mb-6">ğŸš§</div>
          <h2 class="text-2xl md:text-3xl font-bold text-white mb-4">Coming Soon</h2>
          <p class="text-gray-300 mb-6 leading-relaxed">
            Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©/Ø§Ù„Ù…ÙˆØ³Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.<br>
            ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ù„Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ø¯ ÙˆÙ…Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØ£ÙˆØ²Ø§Ù† Ø§Ù„ï¿½ï¿½Ø³Ø§Ø¨.
          </p>
          <div class="bg-white/10 rounded-xl p-4 inline-block">
            <p class="text-gray-400 text-sm mb-2">Developer</p>
            <p class="text-white font-semibold">Khalil Doua</p>
            <a href="https://t.me/KhqLiL" target="_blank" rel="noopener noreferrer" 
               class="inline-flex items-center gap-2 text-purple-300 hover:text-purple-200 mt-2 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
              </svg>
              @KhqLiL
            </a>
          </div>
        </div>
      `;
    }

    // Element SDK Integration
    function onConfigChange(newConfig) {
      document.getElementById('app-title').textContent = newConfig.app_title || defaultConfig.app_title;
      document.getElementById('dev-name').textContent = newConfig.developer_name || defaultConfig.developer_name;
    }

    function mapToCapabilities(cfg) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(cfg) {
      return new Map([
        ["app_title", cfg.app_title || defaultConfig.app_title],
        ["developer_name", cfg.developer_name || defaultConfig.developer_name]
      ]);
    }

    // Initialize
    initGrades();
    renderContent();

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c47b50d97c8cc2b',t:'MTc2OTUxMTIxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
